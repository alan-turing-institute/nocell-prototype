<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"/><meta name="viewport" content="width=device-width, initial-scale=0.8"/><title>3&nbsp;Language Guide</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default"/><link rel="stylesheet" type="text/css" href="racket.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-style.css" title="default"/><link rel="stylesheet" type="text/css" href="manual-racket.css" title="default"/><script type="text/javascript" src="scribble-common.js"></script><script type="text/javascript" src="manual-racket.js"></script><!--[if IE 6]><style type="text/css">.SIEHidden { overflow: hidden; }</style><![endif]--></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist tocviewlisttopspace"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9660;</a></td><td></td><td><a href="index.html" class="tocviewlink" data-pltdoc="x">nocell</a></td></tr></table></div><div class="tocviewsublisttop" style="display: block;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="intro.html" class="tocviewlink" data-pltdoc="x">Introduction</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="get-started.html" class="tocviewlink" data-pltdoc="x">Getting Started</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="lang-guide.html" class="tocviewselflink" data-pltdoc="x">Language Guide</a></td></tr><tr><td align="right">4&nbsp;</td><td><a href="lang-ref.html" class="tocviewlink" data-pltdoc="x">Language Reference</a></td></tr><tr><td align="right">5&nbsp;</td><td><a href="dev-guide.html" class="tocviewlink" data-pltdoc="x">Developers&rsquo; guide</a></td></tr><tr><td align="right">6&nbsp;</td><td><a href="contributing.html" class="tocviewlink" data-pltdoc="x">Contributing</a></td></tr></table></div></div><div class="tocviewlist"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_1&quot;);">&#9658;</a></td><td>3&nbsp;</td><td><a href="lang-guide.html" class="tocviewselflink" data-pltdoc="x">Language Guide</a></td></tr></table><div class="tocviewsublistbottom" style="display: none;" id="tocview_1"><table cellspacing="0" cellpadding="0"><tr><td align="right">3.1&nbsp;</td><td><a href="lang-guide.html#%28part._.Basics%29" class="tocviewlink" data-pltdoc="x">Basics</a></td></tr><tr><td align="right">3.2&nbsp;</td><td><a href="lang-guide.html#%28part._.Program_to_spreadsheet%29" class="tocviewlink" data-pltdoc="x">Program to spreadsheet</a></td></tr><tr><td align="right">3.3&nbsp;</td><td><a href="lang-guide.html#%28part._.Literals%29" class="tocviewlink" data-pltdoc="x">Literals</a></td></tr><tr><td align="right">3.4&nbsp;</td><td><a href="lang-guide.html#%28part._.Defining_values%29" class="tocviewlink" data-pltdoc="x">Defining values</a></td></tr><tr><td align="right">3.5&nbsp;</td><td><a href="lang-guide.html#%28part._.Comments%29" class="tocviewlink" data-pltdoc="x">Comments</a></td></tr><tr><td align="right">3.6&nbsp;</td><td><a href="lang-guide.html#%28part._.Builtins%29" class="tocviewlink" data-pltdoc="x">Builtins</a></td></tr><tr><td align="right">3.7&nbsp;</td><td><a href="lang-guide.html#%28part._.Defining_.Functions%29" class="tocviewlink" data-pltdoc="x">Defining Functions</a></td></tr><tr><td align="right">3.8&nbsp;</td><td><a href="lang-guide.html#%28part._.Elements_of_.Probabilistic_.Programming%29" class="tocviewlink" data-pltdoc="x">Elements of Probabilistic Programming</a></td></tr><tr><td align="right">3.9&nbsp;</td><td><a href="lang-guide.html#%28part._.Modular_programming__.Importing_and_exporting%29" class="tocviewlink" data-pltdoc="x">Modular programming:<span class="mywbr"> &nbsp;</span> Importing and exporting</a></td></tr></table></div></div></div><div class="tocsub"><div class="tocsubtitle">On this page:</div><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#%28part._.Basics%29" class="tocsubseclink" data-pltdoc="x">Basics</a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#%28part._.Program_to_spreadsheet%29" class="tocsubseclink" data-pltdoc="x">Program to spreadsheet</a></td></tr><tr><td><span class="tocsublinknumber">3.3<tt>&nbsp;</tt></span><a href="#%28part._.Literals%29" class="tocsubseclink" data-pltdoc="x">Literals</a></td></tr><tr><td><span class="tocsublinknumber">3.4<tt>&nbsp;</tt></span><a href="#%28part._.Defining_values%29" class="tocsubseclink" data-pltdoc="x">Defining values</a></td></tr><tr><td><span class="tocsublinknumber">3.5<tt>&nbsp;</tt></span><a href="#%28part._.Comments%29" class="tocsubseclink" data-pltdoc="x">Comments</a></td></tr><tr><td><span class="tocsublinknumber">3.6<tt>&nbsp;</tt></span><a href="#%28part._.Builtins%29" class="tocsubseclink" data-pltdoc="x">Builtins</a></td></tr><tr><td><span class="tocsublinknumber">3.6.1<tt>&nbsp;</tt></span><a href="#%28part._.Binary_arithmetic_operations%29" class="tocsubseclink" data-pltdoc="x">Binary arithmetic operations</a></td></tr><tr><td><span class="tocsublinknumber">3.6.2<tt>&nbsp;</tt></span><a href="#%28part._.Boolean_comparison_functions%29" class="tocsubseclink" data-pltdoc="x">Boolean comparison functions</a></td></tr><tr><td><span class="tocsublinknumber">3.6.3<tt>&nbsp;</tt></span><a href="#%28part._.Conditionals%29" class="tocsubseclink" data-pltdoc="x">Conditionals</a></td></tr><tr><td><span class="tocsublinknumber">3.6.4<tt>&nbsp;</tt></span><a href="#%28part._.Folds%29" class="tocsubseclink" data-pltdoc="x">Folds</a></td></tr><tr><td><span class="tocsublinknumber">3.6.5<tt>&nbsp;</tt></span><a href="#%28part._.Shape%29" class="tocsubseclink" data-pltdoc="x">Shape</a></td></tr><tr><td><span class="tocsublinknumber">3.6.6<tt>&nbsp;</tt></span><a href="#%28part._.Indexing%29" class="tocsubseclink" data-pltdoc="x">Indexing</a></td></tr><tr><td><span class="tocsublinknumber">3.7<tt>&nbsp;</tt></span><a href="#%28part._.Defining_.Functions%29" class="tocsubseclink" data-pltdoc="x">Defining Functions</a></td></tr><tr><td><span class="tocsublinknumber">3.8<tt>&nbsp;</tt></span><a href="#%28part._.Elements_of_.Probabilistic_.Programming%29" class="tocsubseclink" data-pltdoc="x">Elements of Probabilistic Programming</a></td></tr><tr><td><span class="tocsublinknumber">3.9<tt>&nbsp;</tt></span><a href="#%28part._.Modular_programming__.Importing_and_exporting%29" class="tocsubseclink" data-pltdoc="x">Modular programming:<span class="mywbr"> &nbsp;</span> Importing and exporting</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="navsettop"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="get-started.html" title="backward to &quot;2 Getting Started&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;nocell&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="lang-ref.html" title="forward to &quot;4 Language Reference&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div><h3>3<tt>&nbsp;</tt><a name="(part._lang-guide)"></a>Language Guide</h3><p>This guide is a quick overview of the nocell language, for users who
would like to produce spreadsheet models quickly.  Nocell is a small
language, and this guide introduces it fully, but it is less detailed
than the complete <a href="lang-ref.html" data-pltdoc="x">Language Reference</a>.</p><p>Some example results are given, and for these the resulting
spreadsheet is represented as a table, like the following one, where
cells A1 and B1 contain numbers, A2 contains the string "hello" and B2
contains a formula.</p><p><table cellspacing="0" cellpadding="0" style="border-collapse: collapse;"><tr><td align="center" style="border: 1px solid black;"><p> </p></td><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">A</span></p></td><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">B</span></p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">1</span></p></td><td align="center" style="border: 1px solid black;"><p>1</p></td><td align="center" style="border: 1px solid black;"><p>3.5</p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">2</span></p></td><td align="center" style="border: 1px solid black;"><p>'hello</p></td><td align="center" style="border: 1px solid black;"><p>=A1+B1</p></td></tr></table></p><p>First we introduce the basic elements of the language, before
introducing the probabilistic aspects.</p><h4>3.1<tt>&nbsp;</tt><a name="(part._.Basics)"></a>Basics</h4><ul><li><p>Your nocell program should begin with the line</p><p><a href="https://docs.racket-lang.org/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><a href="https://docs.racket-lang.org/reference/reader.html#%28mod-path._s-exp%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">s-exp</span></a><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta">nocell</span></p></li><li><p>Nocell is based on Racket, which is a Lisp.</p></li><li><p>Editor support for Racket (which nocell can use) (TODO link)</p></li><li><p>Forms</p></li></ul><h4>3.2<tt>&nbsp;</tt><a name="(part._.Program_to_spreadsheet)"></a>Program to spreadsheet</h4><p>Nocell (and in particular, the nocell-to-ods script) produces a
spreadsheet from a program.  What does this mean?</p><p>A spreadsheet itself is a limited kind of program.  Some popular
spreadsheet applications support extensibility via a scripting
language (for example, a user of Microsoft Excel can write extensions
in VBA).  We do not use this kind of functionality, and by
<span style="font-style: italic">spreadsheet</span> we mean only the contents of the cells.</p><p>A program that converts one representation of a program to another is
a compiler, and so we will refer to nocell in this way.</p><p>To the extent possible [TODO note on this], the nocell compiler
produces a spreadsheet representing the same program as the nocell
program.  This can mean modifying the structure of the program in
certain ways.  For example, since there is no concept of a loop in a
spreadsheet, any loops in the program are unrolled, up to some
pre-defined depth.</p><p>For example, consider the following short nocell program,</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><a href="https://docs.racket-lang.org/guide/Module_Syntax.html#%28part._hash-lang%29" class="RktModLink" data-pltdoc="x"><span class="RktMod">#lang</span></a><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><a href="https://docs.racket-lang.org/reference/reader.html#%28mod-path._s-exp%29" class="RktModLink" data-pltdoc="x"><span class="RktSym">s-exp</span></a><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta">nocell</span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">define</span></span></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">x</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">#[</span><span class="RktVal">1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">2</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">3</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">define</span></span></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">y</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">#[</span><span class="RktVal">10</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">100</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">1000</span><span class="RktPn">]</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">define</span></span></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">result</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">+</span></span></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">x</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktSym">y</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote><p>which compiles to</p><p><table cellspacing="0" cellpadding="0" style="border-collapse: collapse;"><tr><td align="center" style="border: 1px solid black;"><p> </p></td><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">A</span></p></td><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">B</span></p></td><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">C</span></p></td><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">D</span></p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">1</span></p></td><td align="center" style="border: 1px solid black;"><p>'x</p></td><td align="center" style="border: 1px solid black;"><p>1</p></td><td align="center" style="border: 1px solid black;"><p>2</p></td><td align="center" style="border: 1px solid black;"><p>3</p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">2</span></p></td><td align="center" style="border: 1px solid black;"><p>'y</p></td><td align="center" style="border: 1px solid black;"><p>10</p></td><td align="center" style="border: 1px solid black;"><p>100</p></td><td align="center" style="border: 1px solid black;"><p>1000</p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">3</span></p></td><td align="center" style="border: 1px solid black;"><p>'result</p></td><td align="center" style="border: 1px solid black;"><p>=B1+B2</p></td><td align="center" style="border: 1px solid black;"><p>=C1+C2</p></td><td align="center" style="border: 1px solid black;"><p>=D1+D2</p></td></tr></table></p><p><div class="SIntrapara">Some things to notice about this spreadsheet:
</div><div class="SIntrapara"><ul><li><p>The calculation proceeds "downwards".</p></li><li><p>Multiple values are spread across a row.</p></li><li><p>Values and formulae are labelled in the first column with their name, as
<span class="RktSym"><span class="badlink"><span class="RktValLink">define</span></span></span>d in the program.</p></li><li><p>The use of a variable in the program becomes an appropriate
references in the spreadsheet.</p></li><li><p>The spreadsheet is populated with the same values used in the program.</p></li></ul></div></p><p>Some of this is a result of particular layout choices.  We intend for
these choices to be customizable. TODO More on layout</p><h4>3.3<tt>&nbsp;</tt><a name="(part._.Literals)"></a>Literals</h4><p><div class="SIntrapara">The types of literal reflect those commonly found in spreadsheets:
</div><div class="SIntrapara"><ul><li><p>number</p></li><li><p>string</p></li><li><p>boolean</p></li></ul></div></p><p><span style="font-weight: bold">Numbers</span> are represented internally as double-precision
floating-point numbers (I think this is false, and generally a good
thing, but e.g. (/ 1 0) raises an exception, which is undesirable (vs
NaN)).  Some numbers:</p><ul><li><p><span class="RktVal"><span class="nobreak">-1</span></span></p></li><li><p><span class="RktVal">0.0</span></p></li><li><p><span class="RktVal">2.4e+15</span></p></li><li><p><span class="RktVal">+inf.0</span></p></li></ul><p>How these map to number representations used by a particular
spreadsheet will depend on what is supported or available in the
spreadsheet format and the corresponding nocell backend.</p><p>There are two <span style="font-weight: bold">Boolean</span> values, <span class="RktVal">#t</span> (true) and
<span class="RktVal">#f</span> (false).</p><p><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>The array functionality in nocell is built on
<a href="https://docs.racket-lang.org/math/array.html" class="RktModLink" data-pltdoc="x"><span class="RktSym">math/array</span></a>, and inherits a lot of behaviour from it,
for example, broadcasting.</p></blockquote></blockquote></blockquote></div><div class="SIntrapara"><span style="font-weight: bold">Arrays</span> of any rank can be specified using <span class="RktPn">#[</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktPn">]</span><span class="RktMeta"></span>
syntax, which can be nested.  In fact, <span style="font-weight: bold">every</span> value in nocell is
an array, perhaps of rank zero.</div></p><p><div class="SIntrapara">Some rank zero arrays:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktVal">1</span></td></tr><tr><td><p><span class="RktRes">(mutable-array 1)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">+</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(array 2)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktVal">"a string"</span></td></tr><tr><td><p><span class="RktRes">(mutable-array "a string")</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Arrays of rank one or greater:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="hspace">&nbsp;</span><span class="RktVal">6</span><span class="hspace">&nbsp;</span><span class="RktVal">7</span><span class="hspace">&nbsp;</span><span class="RktVal">8</span><span class="hspace">&nbsp;</span><span class="RktVal">9</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="RktVal">]</span></td></tr><tr><td><p><span class="RktRes">(mutable-array #[1 2 3 4 5 6 7 8 9 10])</span></p></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktVal">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktVal">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="hspace">&nbsp;&nbsp;</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktVal">]</span><span class="RktVal">]</span></td></tr></table></td></tr><tr><td><p><span class="RktRes">(mutable-array #[#[1 0 0] #[0 1 0] #[0 0 1]])</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">"a"</span><span class="hspace">&nbsp;</span><span class="RktVal">#f</span><span class="RktVal">]</span></td></tr><tr><td><p><span class="RktRes">(mutable-array #[1 "a" #f])</span></p></td></tr></table></blockquote></div></p><p><div class="SIntrapara">Arrays must be rectangular:</div><div class="SIntrapara"><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">]</span><span class="hspace">&nbsp;</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="RktVal">]</span><span class="RktVal">]</span></td></tr><tr><td><p><span class="RktErr">vector*-&gt;array: contract violation</span></p></td></tr><tr><td><p><span class="RktErr"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktErr">expected: rectangular (Vectorof* A)</span></p></td></tr><tr><td><p><span class="RktErr"></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktErr">given: '#(#(1 2 3) #(1 2))</span></p></td></tr></table></blockquote></div></p><h4>3.4<tt>&nbsp;</tt><a name="(part._.Defining_values)"></a>Defining values</h4><p>There is a special form, <span class="RktSym"><span class="badlink"><span class="RktValLink">define</span></span></span>, that can be used to give
names to values.  There is no mutation in the language: a name (in a
particular scope) always refers to the same value after it has been
defined.</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">define</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">id</span><span class="hspace">&nbsp;</span><span style="font-style: italic">expr</span><span class="RktPn">)</span></p></blockquote><p>evaluates the expression <span style="font-style: italic">expr</span> and binds the result to the
identifier <span class="RktSym">id</span>.</p><p>Scoping rules are inherited from Racket.</p><p>There is another variant of <span class="RktSym"><span class="badlink"><span class="RktValLink">define</span></span></span> for defining functions,
see below.</p><h4>3.5<tt>&nbsp;</tt><a name="(part._.Comments)"></a>Comments</h4><p>Nocell distinguishes between <span style="font-weight: bold">comments</span> and <span style="font-weight: bold">annotations</span>.</p><p>A <span style="font-weight: bold">comment</span>, as in ordinary Racket, follows a semicolon: the text
of the comment is intended for readers of the nocell program and is
ignored by the parser.  It will not show up in any generated
spreadsheet.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktMeta"></span><span class="RktCmt">;;</span><span class="hspace">&nbsp;</span><span class="RktCmt">a</span><span class="hspace">&nbsp;</span><span class="RktCmt">comment</span><span class="RktMeta"></span></td></tr><tr><td><span class="RktMeta"></span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">+</span></span></span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">1</span><span class="RktMeta"></span><span class="hspace">&nbsp;</span><span class="RktMeta"></span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktMeta"></span></td></tr></table></blockquote><p>A value can also be <span style="font-weight: bold">annotated</span> with some explanatory text.
Unlike a comment, this text will show up in the spreadsheet, alongside
the value in question.  The syntax for adding an annotation is</p><blockquote class="SCodeFlow"><p><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">@</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">expr</span><span class="hspace">&nbsp;</span><span class="RktSym">string</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span></p></blockquote><p>The expression <span style="font-style: italic">expr</span> is evaluated, and the resulting value
annotated with the subsequent strings (joined with newlines).</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">define</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">result</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">+</span></span></span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">[</span><span class="RktSym"><span class="badlink"><span class="RktValLink">@</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">*</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktVal">"two times three"</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"is six"</span><span class="RktPn">]</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></blockquote><p><table cellspacing="0" cellpadding="0" style="border-collapse: collapse;"><tr><td align="center" style="border: 1px solid black;"><p> </p></td><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">A</span></p></td><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">B</span></p></td><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">C</span></p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">1</span></p></td><td align="center" style="border: 1px solid black;"><p> </p></td><td align="center" style="border: 1px solid black;"><p>2</p></td><td align="center" style="border: 1px solid black;"><p> </p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">2</span></p></td><td align="center" style="border: 1px solid black;"><p> </p></td><td align="center" style="border: 1px solid black;"><p>3</p></td><td align="center" style="border: 1px solid black;"><p> </p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">3</span></p></td><td align="center" style="border: 1px solid black;"><p> </p></td><td align="center" style="border: 1px solid black;"><p>=B1*B2</p></td><td align="center" style="border: 1px solid black;"><p>'two times three<br/>is six</p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">4</span></p></td><td align="center" style="border: 1px solid black;"><p> </p></td><td align="center" style="border: 1px solid black;"><p>1</p></td><td align="center" style="border: 1px solid black;"><p> </p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">5</span></p></td><td align="center" style="border: 1px solid black;"><p>'result</p></td><td align="center" style="border: 1px solid black;"><p>=B3+B4</p></td><td align="center" style="border: 1px solid black;"><p> </p></td></tr></table></p><h4>3.6<tt>&nbsp;</tt><a name="(part._.Builtins)"></a>Builtins</h4><p>There is a selection of builtin functions, designed to mirror the
built-in functions available for use in spreadsheets.  For some
spreadsheet backends, a builtin might not translate directly into a
single spreadsheet function.</p><h5>3.6.1<tt>&nbsp;</tt><a name="(part._.Binary_arithmetic_operations)"></a>Binary arithmetic operations</h5><p>The following operations are supported: <span class="RktSym"><span class="badlink"><span class="RktValLink">+</span></span></span>, <span class="RktSym"><span class="badlink"><span class="RktValLink">-</span></span></span>,
<span class="RktSym"><span class="badlink"><span class="RktValLink">*</span></span></span>, <span class="RktSym"><span class="badlink"><span class="RktValLink">/</span></span></span>, <span class="RktSym"><span class="badlink"><span class="RktValLink">expt</span></span></span></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">expt</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(array 8)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">/</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktErr">/: division by zero</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">+</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">10</span><span class="hspace">&nbsp;</span><span class="RktVal">100</span><span class="RktVal">]</span><span class="hspace">&nbsp;</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">0</span><span class="RktVal">]</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(array #[1 11 100])</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">expt</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">0</span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="hspace">&nbsp;</span><span class="RktVal">5</span><span class="RktVal">]</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(array #[1 2 4 8 16 32])</span></p></td></tr></table></blockquote><p>The last example demonstrates <font class="badlink">(part "broadcasting")</font>.</p><h5>3.6.2<tt>&nbsp;</tt><a name="(part._.Boolean_comparison_functions)"></a>Boolean comparison functions</h5><p><span class="RktSym"><span class="badlink"><span class="RktValLink">=</span></span></span>, <span class="RktSym"><span class="badlink"><span class="RktValLink">&lt;</span></span></span>, <span class="RktSym"><span class="badlink"><span class="RktValLink">&lt;=</span></span></span>, <span class="RktSym"><span class="badlink"><span class="RktValLink">&gt;</span></span></span>, <span class="RktSym"><span class="badlink"><span class="RktValLink">&gt;=</span></span></span></p><h5>3.6.3<tt>&nbsp;</tt><a name="(part._.Conditionals)"></a>Conditionals</h5><p><span class="RktSym"><span class="badlink"><span class="RktValLink">if</span></span></span> is a function and as such it fully evaluates its
arguments.  This may be surprising, but it is desirable because the
results of both branches can then be included in the spreadsheet (and
if a value on which the condition depends changes, the other branch
can be taken).</p><p><div class="SIntrapara">It is possible to fully explore all branches because
</div><div class="SIntrapara"><ul><li><p>there are no side effects in the language</p></li><li><p>certain errors show up as special error values,
instead of raising exceptions</p></li><li><p>nocell programs always terminate</p></li></ul></div></p><p>See also <font class="badlink">(part "recursion")</font>.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">define</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">)</span></td></tr><tr><td><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">define</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">result</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">if</span></span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">&gt;</span></span></span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="hspace">&nbsp;</span><span class="RktVal">0.0</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">/</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">1.0</span><span class="hspace">&nbsp;</span><span class="RktSym">x</span><span class="RktPn">)</span></td></tr><tr><td><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal"><span class="nobreak">-1</span>.0</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></td></tr></table></blockquote><p><table cellspacing="0" cellpadding="0" style="border-collapse: collapse;"><tr><td align="center" style="border: 1px solid black;"><p> </p></td><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">A</span></p></td><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">B</span></p></td><td align="center" style="border: 1px solid black;"><p>value in <span style="font-weight: bold">B</span></p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">1</span></p></td><td align="center" style="border: 1px solid black;"><p>'x</p></td><td align="center" style="border: 1px solid black;"><p>0.0</p></td><td align="center" style="border: 1px solid black;"><p><span style="font-style: italic">0</span></p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">2</span></p></td><td align="center" style="border: 1px solid black;"><p></p></td><td align="center" style="border: 1px solid black;"><p>0.0</p></td><td align="center" style="border: 1px solid black;"><p><span style="font-style: italic">0</span></p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">3</span></p></td><td align="center" style="border: 1px solid black;"><p></p></td><td align="center" style="border: 1px solid black;"><p>=B1&gt;B2</p></td><td align="center" style="border: 1px solid black;"><p><span style="font-style: italic">FALSE</span></p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">4</span></p></td><td align="center" style="border: 1px solid black;"><p></p></td><td align="center" style="border: 1px solid black;"><p>=1.0/B1</p></td><td align="center" style="border: 1px solid black;"><p><span style="font-style: italic">#DIV/0!</span></p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">5</span></p></td><td align="center" style="border: 1px solid black;"><p></p></td><td align="center" style="border: 1px solid black;"><p>-1.0</p></td><td align="center" style="border: 1px solid black;"><p><span style="font-style: italic">-1.0</span></p></td></tr><tr><td align="center" style="border: 1px solid black;"><p><span style="font-weight: bold">6</span></p></td><td align="center" style="border: 1px solid black;"><p>'result</p></td><td align="center" style="border: 1px solid black;"><p>=IF(B3,B4,B5)</p></td><td align="center" style="border: 1px solid black;"><p><span style="font-style: italic">-1.0</span></p></td></tr></table></p><h5>3.6.4<tt>&nbsp;</tt><a name="(part._.Folds)"></a>Folds</h5><p><span class="RktSym"><span class="badlink"><span class="RktValLink">sum</span></span></span>, <span class="RktSym"><span class="badlink"><span class="RktValLink">product</span></span></span></p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">sum</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktVal">]</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(array 10)</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">product</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="hspace">&nbsp;</span><span class="RktVal">4</span><span class="RktVal">]</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(array 24)</span></p></td></tr></table></blockquote><h5>3.6.5<tt>&nbsp;</tt><a name="(part._.Shape)"></a>Shape</h5><p>The shape of an array can be obtained with <span class="RktSym"><span class="badlink"><span class="RktValLink">len</span></span></span>, which returns
a one-dimensional array.</p><blockquote class="SCodeFlow"><table cellspacing="0" cellpadding="0" class="RktBlk"><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">len</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">1</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(mutable-array #[])</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">len</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">]</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(mutable-array #[3])</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">len</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">]</span><span class="RktVal">]</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(mutable-array #[1 3])</span></p></td></tr><tr><td><span class="stt">&gt; </span><span class="RktPn">(</span><span class="RktSym"><span class="badlink"><span class="RktValLink">len</span></span></span><span class="hspace">&nbsp;</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">]</span><span class="hspace">&nbsp;</span><span class="RktVal">#</span><span class="RktVal">[</span><span class="RktVal">1</span><span class="hspace">&nbsp;</span><span class="RktVal">2</span><span class="hspace">&nbsp;</span><span class="RktVal">3</span><span class="RktVal">]</span><span class="RktVal">]</span><span class="RktPn">)</span></td></tr><tr><td><p><span class="RktRes">(mutable-array #[2 3])</span></p></td></tr></table></blockquote><h5>3.6.6<tt>&nbsp;</tt><a name="(part._.Indexing)"></a>Indexing</h5><p><span class="RktSym"><span class="badlink"><span class="RktValLink">nth</span></span></span></p><h4>3.7<tt>&nbsp;</tt><a name="(part._.Defining_.Functions)"></a>Defining Functions</h4><p>May be recursive</p><p>Mention halt</p><p>Limit to depth</p><h4>3.8<tt>&nbsp;</tt><a name="(part._.Elements_of_.Probabilistic_.Programming)"></a>Elements of Probabilistic Programming</h4><h4>3.9<tt>&nbsp;</tt><a name="(part._.Modular_programming__.Importing_and_exporting)"></a>Modular programming: Importing and exporting</h4><p>require, provide</p><div class="navsetbottom"><span class="navleft"><div class="nosearchform"></div>&nbsp;&nbsp;</span><span class="navright">&nbsp;&nbsp;<a href="get-started.html" title="backward to &quot;2 Getting Started&quot;" data-pltdoc="x">&larr; prev</a>&nbsp;&nbsp;<a href="index.html" title="up to &quot;nocell&quot;" data-pltdoc="x">up</a>&nbsp;&nbsp;<a href="lang-ref.html" title="forward to &quot;4 Language Reference&quot;" data-pltdoc="x">next &rarr;</a></span>&nbsp;</div></div></div><div id="contextindicator">&nbsp;</div></body></html>